$(async function(){ await OLP.loadData(); const id = OLP.getParam('id'); const course = OLP.findCourseById(id); if (!course) { location.href = '404.html'; return; } $('#quizCourse').text(course.title); const form = $('#quizForm'); course.quiz.forEach((q, i) => { const name = `q_${i}`; let opts = ''; q.options.forEach((opt, idx) => { opts += `<label class="card" style="display:flex; gap:.6rem; align-items:center;"> <input type="radio" name="${name}" value="${idx}"> <span>${opt}</span> </label>`; }); form.append(` <div class="card"> <div class="kicker">Question ${i+1} / ${course.quiz.length}</div> <div style="margin:.3rem 0 0.6rem;font-weight:700">${q.question}</div> <div class="grid cols-2">${opts}</div> </div> `); }); $('#submitQuiz').on('click', function(e){ e.preventDefault(); let correct = 0; course.quiz.forEach((q, i) => { const val = $(`input[name='q_${i}']:checked`).val(); if (val !== undefined && parseInt(val,10) === q.answerIndex) correct++; }); const score = Math.round((correct / course.quiz.length) * 100); localStorage.setItem('olp_last_score', JSON.stringify({ id: course.id, correct, total: course.quiz.length, score })); location.href = `result.html?id=${encodeURIComponent(course.id)}`; }); });